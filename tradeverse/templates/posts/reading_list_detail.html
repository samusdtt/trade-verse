{% extends "base.html" %}

{% block title %}{{ reading_list.name }} - {{ config.APP_NAME }}{% endblock %}

{% block content %}
<div class="container py-4">
	<div class="d-flex justify-content-between align-items-center mb-4">
		<div>
			<h2>{{ reading_list.name }}</h2>
			{% if reading_list.description %}
			<p class="text-muted">{{ reading_list.description }}</p>
			{% endif %}
			<div class="d-flex align-items-center gap-3">
				<small class="text-muted">
					<i class="bi bi-person"></i> {{ reading_list.user.name or reading_list.user.username }}
				</small>
				<small class="text-muted">
					<i class="bi bi-calendar"></i> {{ reading_list.created_at.strftime('%B %d, %Y') }}
				</small>
				<small class="text-muted">
					<i class="bi bi-file-text"></i> {{ reading_list.posts|length }} posts
				</small>
				{% if reading_list.is_public %}
				<span class="badge bg-success">Public</span>
				{% else %}
				<span class="badge bg-secondary">Private</span>
				{% endif %}
			</div>
		</div>
		{% if current_user.id == reading_list.created_by %}
		<div class="d-flex gap-2">
			<a href="#" class="btn btn-outline-primary btn-sm">
				<i class="bi bi-pencil"></i> Edit
			</a>
		</div>
		{% endif %}
	</div>

	{% if reading_list.posts %}
	<div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
		{% for post in reading_list.posts %}
		<div class="col">
			<div class="card h-100">
				{% if post.thumbnail_path %}
				<img src="{{ url_for('static', filename=post.thumbnail_path) }}" class="card-thumb" alt="thumbnail">
				{% else %}
				<div class="default-thumb">
					<i class="bi bi-file-text display-4"></i>
				</div>
				{% endif %}
				<div class="card-body">
					<div class="d-flex justify-content-between align-items-start mb-2">
						<span class="badge bg-primary-soft">{{ post.category.name }}</span>
						<small class="text-muted">{{ post.reading_time }} min read</small>
					</div>
					<h5 class="card-title">{{ post.title }}</h5>
					{% if post.excerpt %}
					<p class="card-text text-muted">{{ post.excerpt }}</p>
					{% endif %}
					<div class="d-flex justify-content-between align-items-center mt-3">
						<div class="d-flex align-items-center">
							<small class="text-muted me-3">
								<i class="bi bi-eye"></i> {{ post.views_count }}
							</small>
							<small class="text-muted me-3">
								<i class="bi bi-heart"></i> {{ post.likes_count }}
							</small>
							<small class="text-muted">
								<i class="bi bi-chat"></i> {{ post.comments|length }}
							</small>
						</div>
						<small class="text-muted">{{ post.created_at.strftime('%b %d') }}</small>
					</div>
				</div>
				<div class="card-footer bg-transparent">
					<div class="d-flex justify-content-between align-items-center">
						<small class="text-muted">by {{ post.author.name or post.author.username }}</small>
						<div class="d-flex gap-1">
							<a href="{{ url_for('posts.detail', post_id=post.id) }}" class="btn btn-sm btn-primary">Read</a>
							{% if current_user.id == reading_list.created_by %}
							<form method="POST" action="{{ url_for('posts.remove_from_reading_list', list_id=reading_list.id, post_id=post.id) }}" style="display: inline;">
								<button type="submit" class="btn btn-sm btn-outline-danger" onclick="return confirm('Remove this post from the list?')">
									<i class="bi bi-trash"></i>
								</button>
							</form>
							{% endif %}
						</div>
					</div>
				</div>
			</div>
		</div>
		{% endfor %}
	</div>
	{% else %}
	<div class="text-center py-5">
		<i class="bi bi-list-ul display-1 text-muted"></i>
		<h4 class="mt-3">No Posts in This List</h4>
		<p class="text-muted">This reading list is empty.</p>
		{% if current_user.id == reading_list.created_by %}
		<a href="{{ url_for('main.index') }}" class="btn btn-primary">Find Posts to Add</a>
		{% endif %}
	</div>
	{% endif %}
</div>
{% endblock %}